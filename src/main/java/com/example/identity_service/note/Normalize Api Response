

Normalize API Response : chuẩn hoá api response
Khi client consume api thì họ sẽ handle được trong trường hợp bị lỗi
Là việc đầu tiên phải set up khi khởi tạo dự án
Có thể chuẩn hoá cho việc trả về JSON / Exception

1. Tạo 1 structor để chuấn hoá api res theo format : ApiResponse
2. Thêm các field cần chuân hoá : code, message, T result,...
3. Làm kiểu trả về cho phương thức, truyền dữ liệu User vào field result, mặc định code trả về là 1000(thành công)

ApiResponse<User> createUser(@RequestBody @Valid UserCreationRequest request) {
        ApiResponse<User> apiResponse = new ApiResponse<>();
        apiResponse.setResult(userService.createUser(request));
        return apiResponse;
    }
=> JSON trả về có dạng {
                           "code": 1000,
                           "message": null,
                           "result": {
                               "id": "f6c8634a-b72e-4469-81f1-6020bd814701",
                               "username": "Nguyen4",
                               "password": "admin123",
                               "firstName": "tran",
                               "lastName": "quoc nguyen",
                               "dob": "2003-09-02"
                           }
                       }
@JsonInclude(JsonInclude.Include.NON_NULL) : nếu field = null thì k đưa vào JSON trả về

--------------------------------------------------------------------------------------------------------
Chuẩn hoá API trả về cho Exception Handler

Mỗi ExcHandler sẽ xử lý những Exc khác nhau => code trả về sẽ khác nhau
 -> tạo ra 1 lớp enum chứa Error Code
Enum : lớp chứa tập hợp các giá trị được định sẵn và không thể thay đổi

Tạo 1 lớp chứa định nghĩa Exception : AppException
Exception mới này sẽ kế thừa từ các Lớp ngoại lệ đặc thù
AppException ngoại lệ không kiểm tra (unchecked exceptions)
có nghĩa là bạn không bắt buộc phải xử lý chúng bằng cách sử dụng try-catch hoặc khai báo chúng với throws

=> khi throw Exception(tự định nghĩa), ta gán mã lỗi vào : throw new AppException(ErrorCode.USER_EXISTED);
USER_EXISTED chứa 2 fiels : code-1001, message-"user existed"
GlobalExc sẽ bắt lỗi đấy về xử lý